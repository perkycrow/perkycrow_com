[
  {
    "type": "code",
    "title": "Reserved $ properties",
    "source": "const module = new PerkyModule({\n    $id: 'player',\n    $name: 'Player',\n    $category: 'entity',\n    $tags: ['controllable'],\n    $bind: 'player',\n    $lifecycle: true,\n    $eagerStart: true\n})\n\n// Your own properties are safe\nmodule.health = 100\nmodule.name = 'Hero'  // No conflict with $name\nmodule.id = 'custom'  // No conflict with $id"
  },
  {
    "type": "code",
    "title": "Direct instantiation",
    "source": "const module = new PerkyModule({\n    $id: 'myModule',\n    $category: 'custom',\n    $tags: ['active', 'visible']\n})"
  },
  {
    "type": "code",
    "title": "Subclassing",
    "source": "class Player extends PerkyModule {\n    static $category = 'entity'\n    static $tags = ['controllable']\n\n    onStart () {\n        // Called when module starts\n    }\n}"
  },
  {
    "type": "action",
    "title": "Instance properties",
    "source": "const module = new PerkyModule({\n    $id: 'player',\n    $category: 'entity'\n})\nlogger.log('$id:', module.$id)\nlogger.log('$name:', module.$name)\nlogger.log('$category:', module.$category)\nlogger.log('$status:', module.$status)"
  },
  {
    "type": "action",
    "title": "start / stop",
    "source": "const module = new PerkyModule({$id: 'test'})\nlogger.log('initial status:', module.$status)\n\nmodule.start()\nlogger.log('after start:', module.$status, 'running:', module.running)\n\nmodule.stop()\nlogger.log('after stop:', module.$status, 'running:', module.running)"
  },
  {
    "type": "action",
    "title": "dispose",
    "source": "const module = new PerkyModule({$id: 'test'})\nmodule.start()\nlogger.log('before dispose:', module.$status)\n\nmodule.dispose()\nlogger.log('after dispose:', module.$status, 'disposed:', module.disposed)"
  },
  {
    "type": "action",
    "title": "Lifecycle events",
    "source": "const module = new PerkyModule({$id: 'test'})\nmodule.on('start', () => logger.log('event: start'))\nmodule.on('stop', () => logger.log('event: stop'))\nmodule.on('dispose', () => logger.log('event: dispose'))\n\nmodule.start()\nmodule.stop()\nmodule.dispose()"
  },
  {
    "type": "action",
    "title": "create",
    "source": "const parent = new PerkyModule({$id: 'parent'})\n\nparent.create(PerkyModule, {$id: 'child1', $category: 'component'})\nparent.create(PerkyModule, {$id: 'child2', $category: 'component'})\n\nlogger.log('children:', parent.children.map(c => c.$id))\nlogger.log('hasChild:', parent.hasChild('child1'))\nlogger.log('getChild:', parent.getChild('child1').$id)"
  },
  {
    "type": "action",
    "title": "addChild",
    "source": "const parent = new PerkyModule({$id: 'parent'})\n\n// Create module separately\nconst player = new PerkyModule({$id: 'player', $category: 'entity'})\n\n// Add it later\nparent.addChild(player)\n\nlogger.log('player.host:', player.host.$id)\nlogger.log('player.installed:', player.installed)"
  },
  {
    "type": "action",
    "title": "Lifecycle propagation",
    "source": "const parent = new PerkyModule({$id: 'parent'})\nconst child = parent.create(PerkyModule, {$id: 'child'})\n\nchild.on('start', () => logger.log('child started'))\nchild.on('stop', () => logger.log('child stopped'))\n\nlogger.log('Starting parent...')\nparent.start()\n\nlogger.log('Stopping parent...')\nparent.stop()"
  },
  {
    "type": "action",
    "title": "$eagerStart (default: true)",
    "source": "const parent = new PerkyModule({$id: 'parent'})\nparent.start()\nlogger.log('parent started:', parent.started)\n\n// Child auto-starts because $eagerStart is true by default\nconst eager = parent.create(PerkyModule, {$id: 'eager'})\nlogger.log('eager.started:', eager.started)\n\n// Disable auto-start with $eagerStart: false\nconst lazy = parent.create(PerkyModule, {\n    $id: 'lazy',\n    $eagerStart: false\n})\nlogger.log('lazy.started:', lazy.started)\n\n// Lazy child can be started manually\nlazy.start()\nlogger.log('lazy after manual start:', lazy.started)"
  },
  {
    "type": "action",
    "title": "childrenByCategory",
    "source": "const game = new PerkyModule({$id: 'game'})\ngame.create(PerkyModule, {$id: 'player', $category: 'entity'})\ngame.create(PerkyModule, {$id: 'enemy1', $category: 'entity'})\ngame.create(PerkyModule, {$id: 'score', $category: 'ui'})\n\nconst entities = game.childrenByCategory('entity')\nlogger.log('entities:', entities.map(e => e.$id))"
  },
  {
    "type": "action",
    "title": "removeChild",
    "source": "const game = new PerkyModule({$id: 'game'})\nconst enemy = game.create(PerkyModule, {$id: 'enemy'})\n\nlogger.log('before:', game.hasChild('enemy'))\n\ngame.removeChild('enemy')\nlogger.log('after:', game.hasChild('enemy'))\nlogger.log('enemy disposed:', enemy.disposed)"
  },
  {
    "type": "action",
    "title": "Basic tags",
    "source": "const module = new PerkyModule({\n    $id: 'player',\n    $tags: ['controllable', 'visible']\n})\n\nlogger.log('$tags:', module.$tags)\nlogger.log('hasTag visible:', module.hasTag('visible'))\nlogger.log('hasTags:', module.hasTags(['controllable', 'visible']))"
  },
  {
    "type": "action",
    "title": "addTag / removeTag",
    "source": "const module = new PerkyModule({$id: 'enemy'})\n\nmodule.addTag('hostile')\nmodule.addTag('visible')\nlogger.log('after adding:', module.$tags)\n\nmodule.removeTag('hostile')\nlogger.log('after removing:', module.$tags)"
  },
  {
    "type": "action",
    "title": "childrenByTags",
    "source": "const game = new PerkyModule({$id: 'game'})\ngame.create(PerkyModule, {$id: 'player', $tags: ['entity', 'controllable']})\ngame.create(PerkyModule, {$id: 'enemy', $tags: ['entity', 'hostile']})\ngame.create(PerkyModule, {$id: 'rock', $tags: ['entity']})\n\nlogger.log('entities:', game.childrenByTags('entity').map(c => c.$id))\nlogger.log('hostile:', game.childrenByTags(['entity', 'hostile']).map(c => c.$id))"
  },
  {
    "type": "action",
    "title": "query / queryAll",
    "source": "const app = new PerkyModule({$id: 'app'})\nconst game = app.create(PerkyModule, {$id: 'game', $category: 'scene'})\ngame.create(PerkyModule, {$id: 'player', $category: 'entity', $tags: ['controllable']})\ngame.create(PerkyModule, {$id: 'enemy', $category: 'entity', $tags: ['hostile']})\n\n// Direct child queries\nlogger.log('#game:', app.query('#game')?.$id)\nlogger.log('#game @entity:', app.queryAll('#game @entity').map(e => e.$id))\nlogger.log('#game .hostile:', app.query('#game .hostile')?.$id)"
  },
  {
    "type": "action",
    "title": "on / emit",
    "source": "const module = new PerkyModule({$id: 'test'})\n\nmodule.on('damage', amount => {\n    logger.log('received damage:', amount)\n})\n\nmodule.emit('damage', 25)\nmodule.emit('damage', 50)"
  },
  {
    "type": "action",
    "title": "listenTo",
    "source": "const player = new PerkyModule({$id: 'player'})\nconst enemy = new PerkyModule({$id: 'enemy'})\n\nplayer.listenTo(enemy, 'attack', damage => {\n    logger.log('player received attack:', damage)\n})\n\nenemy.emit('attack', 30)"
  },
  {
    "type": "action",
    "title": "delegateTo",
    "source": "class AudioSystem extends PerkyModule {\n    play (sound) {\n        logger.log('playing:', sound)\n    }\n\n    stop () {\n        logger.log('stopping audio')\n    }\n\n    onInstall (host) {\n        this.delegateTo(host, ['play', 'stop'])\n    }\n}\n\nconst game = new PerkyModule({$id: 'game'})\ngame.create(AudioSystem, {$id: 'audio'})\n\ngame.play('explosion.mp3')\ngame.stop()"
  },
  {
    "type": "action",
    "title": "delegateEventsTo",
    "source": "const game = new PerkyModule({$id: 'game'})\nconst player = game.create(PerkyModule, {$id: 'player'})\n\nplayer.delegateEventsTo(game, ['damage', 'death'], 'player')\n\ngame.on('player:damage', amount => logger.log('game heard player damage:', amount))\ngame.on('player:death', () => logger.log('game heard player death'))\n\nplayer.emit('damage', 50)\nplayer.emit('death')"
  },
  {
    "type": "action",
    "title": "link / unlink",
    "source": "const game = new PerkyModule({$id: 'game'})\nconst textureSystem = game.create(PerkyModule, {$id: 'textureSystem'})\n\nconst tool = new PerkyModule({$id: 'tool'})\ntool.link(textureSystem, 'textures')\n\nlogger.log('linked:', tool.textures.$id)\nlogger.log('hasLinked:', tool.hasLinked('textures'))\n\ntool.unlink('textures')\nlogger.log('after unlink:', tool.hasLinked('textures'))"
  },
  {
    "type": "action",
    "title": "Auto-unlink on dispose",
    "source": "const moduleA = new PerkyModule({$id: 'moduleA'})\nconst moduleB = new PerkyModule({$id: 'moduleB'})\n\nmoduleA.link(moduleB, 'ref')\nmoduleA.on('unlink', (key) => logger.log('unlinked:', key))\n\nlogger.log('before dispose:', moduleA.hasLinked('ref'))\nmoduleB.dispose()\nlogger.log('after dispose:', moduleA.hasLinked('ref'))"
  },
  {
    "type": "code",
    "title": "Link without binding",
    "source": "const moduleA = new PerkyModule({$id: 'moduleA'})\nconst moduleB = new PerkyModule({$id: 'moduleB'})\n\nmoduleA.link(moduleB)              // creates moduleA.moduleB\nmoduleA.link(moduleB, 'custom')    // creates moduleA.custom\nmoduleA.link(moduleB, false)       // no binding, use getLinked()"
  }
]